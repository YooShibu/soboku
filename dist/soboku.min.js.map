{"version":3,"file":"soboku.min.js","sources":["../src/util.ts","../src/reporter/reporter.ts","../src/state/state.ts","../src/calc/calc.ts","../src/reporter/gate.ts","../src/state/sarray.ts","../src/calc/combine.ts","../src/calc/editer.ts","../src/calc/trigger.ts","../src/calc/publisher.ts"],"sourcesContent":["import { IStateHolder } from \"../index.d\";\r\nimport { Depends } from \"./calc/calc\";\r\nimport { ReporterClass, ListenerClass } from \"./reporter/reporter\";\r\n\r\n\r\nexport function optimizeCB<T>(func: (...args: any[]) => T): (args: any[]) => T {\r\n    switch (func.length) {\r\n        case 1:\r\n            return (args: any[]) => func(args[0])\r\n        case 2:\r\n            return (args: any[]) => func(args[0], args[1]);\r\n        case 3:\r\n            return (args: any[]) => func(args[0], args[1], args[2]);\r\n        case 4:\r\n            return (args: any[]) => func(args[0], args[1], args[2], args[3]);\r\n        default:\r\n            return (args: any[]) => func.apply(undefined, args);\r\n    }\r\n}\r\n\r\nexport function has(obj: object, key: string): boolean {\r\n    return Object.prototype.hasOwnProperty.call(obj, key);\r\n}\r\n\r\nexport function unique<T>(arr: T[]): T[] {\r\n    const result: T[] = [];\r\n    for (let i = 0; arr.length > i; ++i) {\r\n        const val = arr[i];\r\n        if (indexOf(result, val) === -1) {\r\n            result.push(val);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function identity<T>(x: T): T {\r\n    return x;\r\n}\r\n\r\nexport function indexOf<T>(arr: T[], val: T): number {\r\n    for (let i = 0; arr.length > i; ++i) {\r\n        if (arr[i] === val) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n\r\nexport function spliceOne<T>(arr: T[], index: number): void {\r\n    if (0 > index) {\r\n        return;\r\n    }\r\n    for (let i = index, j = index + 1; arr.length > j; ++i, ++j) {\r\n        arr[i] = arr[j];\r\n    }\r\n    arr.pop();\r\n}\r\n\r\nexport function map<T, U>(arr: T[], iteratee: (val: T) => U): U[] {\r\n    const result: U[] = [];\r\n    for (let i = 0; arr.length > i; ++i) {\r\n        result.push(iteratee(arr[i]));\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function mapObj<T extends { [key: string]: any }, U extends { [key: string]: any }>(obj: T, iteratee: <K1 extends keyof T, K2 extends keyof U>(val: T[K1]) => U[K2]): U {\r\n    const result: { [key: string]: any } = {};\r\n    for (let key in obj) {\r\n        result[key] = iteratee(obj[key]);\r\n    }\r\n    return result as U;\r\n}\r\n\r\nexport function isSobokuReporter(x: any): x is ReporterClass<any> {\r\n    return typeof x === \"object\" && x instanceof ReporterClass;\r\n}\r\n\r\nexport function isStateHolder(x: any): x is IStateHolder<any> {\r\n    return typeof x === \"object\"  && typeof x.s === \"function\";\r\n}\r\n\r\nexport function isDepends(x: any): x is Depends {\r\n    return isSobokuReporter(x) && has(x, \"depends\");\r\n}\r\n","import { Listener, IReporter, IListener, IProgressable, IUnsubscriber, Reporter } from \"../../index.d\";\r\nimport * as u from \"../util\";\r\n\r\n\r\nclass UnListenerClass<T> implements IUnsubscriber {\r\n    private listeners: IListener<any>[] | null;\r\n    private listener: IListener<T> | null;\r\n    \r\n    constructor(listeners: IListener<any>[], listener: IListener<T>) {\r\n        this.listeners = listeners;\r\n        this.listener = listener;\r\n    }\r\n\r\n    public unsubscribe() {\r\n        const listeners = this.listeners;\r\n        if (listeners === null) {\r\n            return;\r\n        }\r\n        const i = u.indexOf(listeners, this.listener);\r\n        u.spliceOne(listeners, i);\r\n        this.listeners = null;\r\n        this.listener = null;\r\n    }\r\n    \r\n}\r\n\r\nexport class ListenerClass<T> implements IListener<T> {\r\n\r\n    constructor(private readonly listener: Listener<T>, private readonly thisArg?: any) {\r\n        if (typeof listener !== \"function\") {\r\n            throw new TypeError(\"'listener' must be a function\");\r\n        }\r\n    }\r\n\r\n    public read(news: T) {\r\n        this.listener.call(this.thisArg, news);\r\n    }\r\n    \r\n}\r\n\r\nclass ListenerOnceClass<T> implements IListener<T> {\r\n    public unsubscriber: IUnsubscriber;\r\n\r\n    constructor(private readonly listener: IListener<T>) {}\r\n\r\n    public read(news: T) {\r\n        this.listener.read(news);\r\n        this.unsubscriber.unsubscribe();\r\n    }\r\n\r\n}\r\n\r\nexport class ReporterClass<T> implements IReporter<T>, IProgressable<T> {\r\n    private readonly listeners: IListener<T>[] = [];\r\n\r\n    public next(val: T): T {\r\n        const listeners = this.listeners;\r\n        for (let i = 0; listeners.length > i; ++i) {\r\n            listeners[i].read(val);\r\n        }\r\n        return val;\r\n    }\r\n\r\n    public report(listener: Listener<T> | ListenerClass<T>): IUnsubscriber {\r\n        const _listener = toListener(listener);\r\n        this.listeners.push(_listener);\r\n        return new UnListenerClass(this.listeners, _listener);\r\n    }\r\n\r\n    public reportOnce(listener: Listener<T> | ListenerClass<T>): IUnsubscriber {\r\n        const _listener = new ListenerOnceClass(toListener(listener));\r\n        this.listeners.push(_listener);\r\n        return _listener.unsubscriber = new UnListenerClass(this.listeners, _listener);\r\n    }\r\n\r\n    public listenerCount(): number {\r\n        return this.listeners.length;\r\n    }\r\n\r\n}\r\n\r\nfunction toListener<T>(listener: Listener<T> | ListenerClass<T>): ListenerClass<T> {\r\n    return listener instanceof ListenerClass\r\n        ? listener\r\n        : new ListenerClass(listener);\r\n}\r\n\r\nexport function reporter<T>(): Reporter<T> {\r\n    return new ReporterClass();\r\n}\r\n\r\nexport function listener<T>(listener: Listener<T>, thisArg?: any): ListenerClass<T> {\r\n    return new ListenerClass(listener, thisArg);\r\n}\r\n","import { Atom, IProgressable, State, IStateHolder } from \"../../index.d\";\r\nimport { ReporterClass, ListenerClass } from \"../reporter/reporter\";\r\nimport * as u from \"../util\";\r\n\r\n\r\nclass StateClass<T> extends ReporterClass<T> implements IProgressable<T> {\r\n\r\n    constructor(private state: T) {\r\n        super();\r\n    }\r\n\r\n    public next(val: T): T {\r\n        this.state = val;\r\n        return super.next(val);\r\n    }\r\n\r\n    public s() {\r\n        return this.state;\r\n    }\r\n    \r\n}\r\n\r\nclass StateHolderClass<T> implements IStateHolder<T> {\r\n\r\n    constructor(private readonly state: T) {}\r\n\r\n    public s() {\r\n        return this.state;\r\n    }\r\n    \r\n}\r\n\r\nexport function state<T>(initial: T): State<T> {\r\n    return new StateClass(initial);\r\n}\r\n\r\nexport function toStateHolder<T>(atom: Atom<T>): IStateHolder<T> {\r\n    if (u.isStateHolder(atom)) {\r\n        return atom;\r\n    }\r\n    return new StateHolderClass(atom);\r\n}\r\n","import { Atom, IStateHolder } from \"../../index.d\";\r\nimport { toStateHolder } from \"../state/state\";\r\nimport { ReporterClass, ListenerClass } from \"../reporter/reporter\";\r\nimport * as u from \"../util\";\r\n\r\nexport type Depends = { readonly depends: ReporterClass<any>[] };\r\n\r\nexport function getDeps(atoms: Atom<any>[]): ReporterClass<any>[] {\r\n    let result: ReporterClass<any>[] = [];\r\n    for (let i = 0; atoms.length > i; ++i) {\r\n        const atom = atoms[i];\r\n        if(u.isDepends(atom)) {\r\n            result = result.concat(atom.depends);\r\n        } else if (u.isSobokuReporter(atom)) {\r\n            result.push(atom);\r\n        }\r\n    }\r\n    return u.unique(result);\r\n}\r\n\r\nexport function getState<T>(sh: IStateHolder<T>): T {\r\n    return sh.s();\r\n}\r\n\r\nexport abstract class CalcClass<T> extends ReporterClass<T> implements IStateHolder<T>, Depends {\r\n    public readonly depends: ReporterClass<any>[] = [];\r\n\r\n    public abstract s(): T;\r\n\r\n    protected addDepends(atoms: Atom<any>[], listener: ListenerClass<any>) {\r\n        const depends = getDeps(atoms);\r\n        for (let i = 0; depends.length > i; ++i) {\r\n            depends[i].report(listener);\r\n        }\r\n        this.depends.push.apply(this.depends, depends);\r\n    }\r\n\r\n    protected listener(val: T): void {\r\n        this.next(this.s());\r\n    };\r\n    \r\n}\r\n","import { IReporter, IStateHolder } from \"../../index.d\";\r\nimport { ReporterClass, ListenerClass } from \"./reporter\";\r\n\r\n\r\nclass GateClass<T> extends ReporterClass<T> {\r\n\r\n    constructor(private readonly gatekeeper: IStateHolder<boolean>, reporter: IReporter<T>) {\r\n        super();\r\n        reporter.report(new ListenerClass(this.listener, this));\r\n    }\r\n\r\n    private listener(val: T): void {\r\n        if (this.gatekeeper.s()) {\r\n            this.next(val);\r\n        }\r\n    }\r\n    \r\n}\r\n\r\nexport function gate<T>(gatekeeper: IStateHolder<boolean>, reporter: IReporter<T>): IReporter<T> {\r\n    return new GateClass(gatekeeper, reporter);\r\n}","import { ISArray } from \"../../index.d\";\r\nimport { ReporterClass } from \"../reporter/reporter\";\r\n\r\n\r\nclass SobokuArrayClass<T> extends ReporterClass<T[]> implements ISArray<T> {\r\n    private readonly array: T[] = [];\r\n\r\n    constructor(array?: T[]) {\r\n        super();\r\n        this.array = array || [];\r\n    }\r\n        \r\n    public s(): T[] {\r\n        return this.array;\r\n    }\r\n\r\n    public pop(): T | undefined {\r\n        const result = this.array.pop();\r\n        this.next(this.array);\r\n        return result;\r\n    }\r\n\r\n    public push(): number {\r\n        const i = Array.prototype.push.apply(this.array, arguments);\r\n        this.next(this.array);\r\n        return i;\r\n    }\r\n\r\n    public reverse(): T[] {\r\n        this.array.reverse();\r\n        this.next(this.array);\r\n        return this.array;\r\n    }\r\n\r\n    public shift(): T | undefined {\r\n        const result = this.array.shift();\r\n        this.next(this.array);\r\n        return result;\r\n    }\r\n\r\n    public sort(compareFn?: (a: T, b: T) => number): T[] {\r\n        this.array.sort(compareFn);\r\n        this.next(this.array);\r\n        return this.array;\r\n    }\r\n    \r\n    public splice(): T[] {\r\n        Array.prototype.splice.apply(this.array, arguments);\r\n        this.next(this.array);\r\n        return this.array;\r\n    }\r\n\r\n    public unshift(): number {\r\n        const result = Array.prototype.unshift.apply(this.array, arguments);\r\n        this.next(this.array);\r\n        return result;\r\n    }\r\n\r\n}\r\n\r\nexport function sarray<T>(array?: T[]): ISArray<T> {\r\n    return new SobokuArrayClass<T>(array);\r\n}","import { Atom, Calc, IStateHolder } from \"../../index.d\";\r\nimport { toStateHolder } from \"../state/state\";\r\nimport { ListenerClass } from \"../reporter/reporter\";\r\nimport * as u from \"../util\";\r\nimport { CalcClass, getState } from \"./calc\";\r\n\r\n\r\nclass CombineClass<T> extends CalcClass<T> {\r\n    private readonly shObj: { [K in keyof T]: IStateHolder<T[K]> };\r\n\r\n    constructor(atomObj: { [K in keyof T]: Atom<T[K]>}) {\r\n        super();\r\n        const atoms: Atom<any>[] = [];\r\n        for (let key in atomObj) {\r\n            atoms.push(atomObj[key]);\r\n        }\r\n        super.addDepends(atoms, new ListenerClass(this.listener, this));\r\n        this.shObj = u.mapObj(atomObj, toStateHolder);\r\n    }\r\n\r\n    public s() {\r\n        return u.mapObj<{ [K in keyof T]: IStateHolder<T[K]> }, T>(this.shObj, getState);\r\n    }\r\n    \r\n}\r\n\r\nexport function combine<T>(atomObj: { [K in keyof T]: Atom<T[K]>}): Calc<T> {\r\n    return new CombineClass(atomObj);\r\n}\r\n","import { Atom, Calc, IStateHolder } from \"../../index.d\";\r\nimport { toStateHolder } from \"../state/state\";\r\nimport { ListenerClass } from \"../reporter/reporter\";\r\nimport * as u from \"../util\";\r\nimport { CalcClass, getState } from \"./calc\";\r\n\r\n\r\nexport class EditerClass<T> extends CalcClass<T> {\r\n    private readonly func: (args: any[]) => T;\r\n    private readonly states: IStateHolder<any>[];\r\n\r\n    constructor(func: (...args: any[]) => T, atoms: Atom<any>[]) {\r\n        super();\r\n        this.func = u.optimizeCB(func);\r\n        this.states = u.map(atoms, toStateHolder);\r\n        super.addDepends(atoms, new ListenerClass(this.listener, this));\r\n    }\r\n\r\n    public s(): T {\r\n        const args = u.map(this.states, getState);\r\n        return this.func(args);\r\n    }\r\n\r\n}\r\n\r\nexport function editer<T>(func: (...args: any[]) => T, atoms: Atom<any>[]): Calc<T> {\r\n    return new EditerClass(func, atoms);\r\n}","import { Atom, Calc, IStateHolder } from \"../../index.d\";\r\nimport { ListenerClass } from \"../reporter/reporter\";\r\nimport * as u from \"../util\";\r\nimport { CalcClass } from \"./calc\";\r\n\r\n\r\nclass TriggerClass extends CalcClass<boolean> {\r\n\r\n    constructor(private readonly condition: Calc<boolean>) {\r\n        super();\r\n        const listener = new ListenerClass(this.onConditionChanged, this);\r\n        super.addDepends([condition], listener);\r\n    }\r\n\r\n    private onConditionChanged() {\r\n        const s = this.s();\r\n        if (s)\r\n            this.next(s);\r\n    }\r\n\r\n    public s() {\r\n        return this.condition.s();\r\n    }\r\n\r\n}\r\n\r\nclass NTriggerClass extends TriggerClass {\r\n\r\n    public s() {\r\n        return !super.s()\r\n    }\r\n    \r\n}\r\n\r\nexport function trigger(condition: Calc<boolean>): Calc<boolean> {\r\n    return new TriggerClass(condition);\r\n}\r\n\r\nexport function ntrigger(condition: Calc<boolean>): Calc<boolean> {\r\n    return new NTriggerClass(condition);\r\n}\r\n","import { Calc, IStateHolder } from \"../../index.d\";\r\nimport { ReporterClass, ListenerClass } from \"../reporter/reporter\";\r\nimport * as u from \"../util\";\r\nimport { CalcClass } from \"./calc\";\r\n\r\n\r\nclass PublisherClass<T> extends CalcClass<T> {\r\n    private prevPermition: boolean;\r\n\r\n    constructor(private readonly permition: Calc<boolean>, private readonly reporter: Calc<T>) {\r\n        super();\r\n        this.prevPermition = permition.s();\r\n        super.addDepends([permition], new ListenerClass(this.permitionChanged, this));\r\n        super.addDepends([reporter], new ListenerClass(this.publish, this));\r\n    }\r\n\r\n    public s(): T {\r\n        return this.reporter.s();\r\n    }\r\n    \r\n    private publish() {\r\n        if (this.permition.s()) {\r\n            this.next(this.reporter.s());\r\n        }\r\n    }\r\n\r\n    private permitionChanged() {\r\n        const permition = this.permition.s();\r\n        if (permition && this.prevPermition === false) {\r\n            this.next(this.reporter.s());\r\n        }\r\n        this.prevPermition = permition;\r\n    }\r\n    \r\n}\r\n\r\nexport function publisher<T>(permition: Calc<boolean>, reporter: Calc<T>): Calc<T> {\r\n    return new PublisherClass(permition, reporter);\r\n}\r\n"],"names":["func","length","args","apply","undefined","obj","key","Object","prototype","hasOwnProperty","call","arr","result","i","val","indexOf","push","index","j","pop","iteratee","x","ReporterClass","s","isSobokuReporter","has","listener","ListenerClass","atom","u.isStateHolder","StateHolderClass","atoms","u.isDepends","concat","depends","u.isSobokuReporter","u.unique","sh","listeners","this","UnListenerClass","u.spliceOne","u.indexOf","thisArg","TypeError","news","ListenerOnceClass","read","unsubscriber","unsubscribe","_listener","toListener","state","_super","_this","__extends","StateClass","next","gatekeeper","reporter","report","GateClass","array","SobokuArrayClass","Array","arguments","reverse","shift","compareFn","sort","splice","unshift","CalcClass","getDeps","atomObj","addDepends","shObj","u.mapObj","toStateHolder","CombineClass","getState","u.optimizeCB","states","u.map","EditerClass","condition","onConditionChanged","TriggerClass","NTriggerClass","permition","prevPermition","permitionChanged","publish","PublisherClass","initial"],"mappings":"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"}